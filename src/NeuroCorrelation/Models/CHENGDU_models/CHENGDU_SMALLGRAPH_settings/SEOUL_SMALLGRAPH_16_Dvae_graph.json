{
    "VAE": {
        "dual_input_mode": true,
        "comment": "VAE modificato per accettare due input concatenati",
        "encoder_layers": [
            {
                "layer": "DualInputProcessor",
                "comment": "Layer custom per processare due input separatamente e poi concatenarli",
                "input_1_layers": [
                    {"layer": "GCNConv_Permute", "in_channels": 1, "out_channels": 1, "in_permute":[0, 2, 1], "out_permute":[0, 2, 1]},
                    {"layer": "Tanh"}
                ],
                "input_2_layers": [
                    {"layer": "GCNConv_Permute", "in_channels": 1, "out_channels": 1, "in_permute":[0, 2, 1], "out_permute":[0, 2, 1]},
                    {"layer": "Tanh"}
                ],
                "fusion_mode": "concatenate"
            },
            {"layer": "Linear", "in_features": 32, "out_features": 20, "comment": "32 = 16*2 dopo concatenazione"},
            {"layer": "Tanh"},
            {"layer": "BatchNorm1d", "num_features": 1, "affine": true},
            {"layer": "Linear", "in_features": 20, "out_features": 15},
            {"layer": "Tanh"},
            {"layer": "Parallel", "layers": [
                {"name": "mu", "layers": [
                    {"layer": "Linear", "in_features": 15, "out_features": 8, "name": "mu_dense"},
                    {"layer": "Tanh"},
                    {"layer": "BatchNorm1d", "num_features": 1, "affine": true}
                ]},
                {"name": "logvar", "layers": [
                    {"layer": "Linear", "in_features": 15, "out_features": 8, "name": "logvar_dense"},
                    {"layer": "Tanh"},
                    {"layer": "BatchNorm1d", "num_features": 1, "affine": true}
                ]}
            ]}
        ],
        "decoder_layers": [
            {"layer": "Linear", "in_features": 8, "out_features": 15},
            {"layer": "Tanh"},
            {"layer": "Linear", "in_features": 15, "out_features": 20},
            {"layer": "Tanh"},
            {"layer": "Linear", "in_features": 20, "out_features": 32},
            {"layer": "Tanh"},
            {
                "layer": "DualOutputProcessor",
                "comment": "Layer custom per dividere l'output in due parti",
                "split_size": 16,
                "output_1_layers": [
                    {"layer": "GCNConv_Permute", "in_channels": 1, "out_channels": 1, "in_permute":[0, 2, 1], "out_permute":[0, 2, 1]}
                ],
                "output_2_layers": [
                    {"layer": "GCNConv_Permute", "in_channels": 1, "out_channels": 1, "in_permute":[0, 2, 1], "out_permute":[0, 2, 1]}
                ]
            }
        ],
        "loss_config": {
            "type": "dual_reconstruction",
            "reconstruction_weight_1": 1.0,
            "reconstruction_weight_2": 1.0,
            "kl_weight": 0.1
        }
    },
    "VAE_SIMPLE_CONCAT": {
        "comment": "Versione alternativa piÃ¹ semplice che mantiene la struttura originale",
        "encoder_layers": [
            {"layer": "Concatenate", "dim": 2, "comment": "Concatena i due input lungo la dimensione delle features"},
            {"layer": "GCNConv_Permute", "in_channels": 1, "out_channels": 1, "in_permute":[0, 2, 1], "out_permute":[0, 2, 1]},
            {"layer": "Tanh"},
            {"layer": "Linear", "in_features": 32, "out_features": 20, "comment": "Raddoppiato da 16 a 32 per i due input"},
            {"layer": "Tanh"},
            {"layer": "BatchNorm1d", "num_features": 1, "affine": true},
            {"layer": "Linear", "in_features": 20, "out_features": 15},
            {"layer": "Tanh"},
            {"layer": "Parallel", "layers": [
                {"name": "mu", "layers": [
                    {"layer": "Linear", "in_features": 15, "out_features": 8, "name": "mu_dense"},
                    {"layer": "Tanh"},
                    {"layer": "BatchNorm1d", "num_features": 1, "affine": true}
                ]},
                {"name": "logvar", "layers": [
                    {"layer": "Linear", "in_features": 15, "out_features": 8, "name": "logvar_dense"},
                    {"layer": "Tanh"},
                    {"layer": "BatchNorm1d", "num_features": 1, "affine": true}
                ]}
            ]}
        ],
        "decoder_layers": [
            {"layer": "Linear", "in_features": 8, "out_features": 15},
            {"layer": "Tanh"},
            {"layer": "Linear", "in_features": 15, "out_features": 20},
            {"layer": "Tanh"},
            {"layer": "Linear", "in_features": 20, "out_features": 32},
            {"layer": "Tanh"},
            {"layer": "GCNConv_Permute", "in_channels": 1, "out_channels": 1, "in_permute":[0, 2, 1], "out_permute":[0, 2, 1]},
            {"layer": "Split", "split_size": [16, 16], "dim": 2, "comment": "Divide l'output in due parti uguali"}
        ]
    }
}